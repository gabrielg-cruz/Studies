* Microsoft COBOL Version 4.5        L2.4 revision 002 16-Oct-23 21:13 Page   1
*                                       EX05.CBL
* Options: LIST(EX05.LST) ASMLIST(EX05.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX05.
     3 AUTHOR. LUIZ HENRIQUE DE SANTANA / GABRIEL GOMES DA CRUZ.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 12/10/2023.
     6 DATE-COMPILED. 16-Oct-23 21:13.
     7 SECURITY. APENAS O AUTOR PODE MODIFICA-LO.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11     SOURCE-COMPUTER.    IBM-PC.
    12     OBJECT-COMPUTER.    IBM-PC.
    13     SPECIAL-NAMES.      DECIMAL-POINT IS COMMA.
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16     SELECT ARQALU ASSIGN TO DISK ORGANIZATION
    17         IS LINE SEQUENTIAL.
    18     SELECT ARQREP ASSIGN TO DISK ORGANIZATION
    19         IS LINE SEQUENTIAL.
    20     SELECT RELAPROV ASSIGN TO DISK.
    21
    22 DATA DIVISION.
    23 FILE SECTION.
    24 FD ARQALU LABEL RECORD ARE STANDARD
    25     VALUE OF FILE-ID IS "ARQALU.DAT".
    26     01 REG-MATRICULA-ALU.
    27       02 MATRICULA-ALU  PIC 9(07).
    28       02 MATRICULA-ALU-RED REDEFINES MATRICULA-ALU.
    29         03 MAT-P1       PIC 9(06).
    30         03 MAT-P2       PIC 9(01).
    31       02 NOME-ALU         PIC X(30).
    32       02 NOTA1-ALU        PIC 9(02)V9(02).
    33       02 NOTA2-ALU        PIC 9(02)V9(02).
    34       02 NOTA3-ALU        PIC 9(02)V9(02).
    35       02 FALT-ALU         PIC 9(02).
    36       02 SEX-ALU          PIC X(01).
    37
    38 FD ARQREP LABEL RECORD ARE STANDARD
    39     VALUE OF FILE-ID IS "ARQREP.DAT".
    40     01 REG-REP.
    41       02 MATRICULA-REP    PIC 9(07).
    42       02 NOME-REP         PIC X(30).
    43       02 NOTA1-REP        PIC 9(02)V9(02).
    44       02 NOTA2-REP        PIC 9(02)V9(02).
    45       02 NOTA3-REP        PIC 9(02)V9(02).
    46       02 FALT-REP         PIC 9(02).
    47       02 SEX-REP          PIC X(01).
    48
    49 FD RELAPROV LABEL RECORD IS OMITTED.
    50     01 REG-ATR              PIC X(80).
    51
    52 WORKING-STORAGE SECTION.
    53     77 FIM-ARQ PIC X(03) VALUE "NAO".
    54     77 CT-LIN PIC 99 VALUE 26.
    55     77 CT-PAG PIC 99 VALUE ZEROS.
    56     77 WSOMA PIC 9(02)V9(02) VALUE ZEROS.
    57     77 WMEDIA PIC 9(02)V9(02) VALUE ZEROS.
* Microsoft COBOL Version 4.5        L2.4 revision 002 16-Oct-23 21:13 Page   2
*                                       EX05.CBL
    58     77 WSOMA-MEDIAS PIC 9(05)V9(02) VALUE ZEROS.
    59     77 CT-ALUNOS-APROVADOS PIC 9(05) VALUE ZEROS.
    60     77 WMEDIA-TURMA PIC 9(02)V9(02) VALUE ZEROS.
    61
    62 01 CAB-01.
    63     02 FILLER PIC X(20) VALUE SPACES.
    64     02 FILLER PIC X(19) VALUE "RELAÇÃO DE ALUNOS".
    65     02 FILLER PIC X(01) VALUE SPACE.
    66     02 FILLER PIC X(09) VALUE "APROVADOS".
    67     02 FILLER PIC X(14) VALUE SPACES.
    68     02 FILLER PIC X(04) VALUE "PAG ".
    69     02 VAR-PAG PIC 9(03).
    70     02 FILLER PIC X(10) VALUE SPACES.
    71
    72 01 CAB-02.
    73     02 FILLER PIC X(08) VALUE SPACES.
    74     02 FILLER PIC X(07) VALUE "NÚMERO".
    75     02 FILLER PIC X(16) VALUE SPACES.
    76     02 FILLER PIC X(13) VALUE "NOME DO ALUNO".
    77     02 FILLER PIC X(14) VALUE SPACES.
    78     02 FILLER PIC X(05) VALUE "MEDIA".
    79     02 FILLER PIC X(08) VALUE SPACES.
    80     02 FILLER PIC X(06) VALUE "FALTAS".
    81     02 FILLER PIC X(03) VALUE SPACES.
    82
    83 01 DETALHE.
    84     02 FILLER PIC X(08) VALUE SPACES.
    85     02 DET-MATRICULA-P1 PIC 9(06).
    86     02 FILLER PIC X(01) VALUE "-".
    87     02 DET-MATRICULA-P2 PIC 9(01).
    88     02 FILLER PIC X(06) VALUE SPACES.
    89     02 DET-NOME PIC X(30).
    90     02 FILLER PIC X(05) VALUE SPACES.
    91     02 DET-MEDIA PIC Z9,99.
    92     02 FILLER PIC X(07) VALUE SPACES.
    93     02 DET-FALTAS PIC 99.
    94     02 FILLER PIC X(08) VALUE SPACES.
    95
    96 01 TOTAL.
    97     02 FILLER PIC X(08) VALUE SPACES.
    98     02 FILLER PIC X(28) VALUE "Total de alunos aprovados: ".
    99     02 TOT-ALUNOS-APROVADOS PIC 9(05).
   100     02 FILLER PIC X(39) VALUE SPACES.
   101
   102 01 GERAL.
   103     02 FILLER PIC X(08) VALUE SPACES.
   104     02 FILLER PIC X(27) VALUE "Media geral da turma     :".
   105     02 GER-MEDIA-GERAL PIC Z9,99.
   106     02 FILLER PIC X(40) VALUE SPACES.
   107
   108 PROCEDURE DIVISION.
   109 PGM-EX05.
   110     PERFORM INICIO.
   111     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   112     PERFORM TERMINO.
   113     STOP RUN.
   114
   115 INICIO.
* Microsoft COBOL Version 4.5        L2.4 revision 002 16-Oct-23 21:13 Page   3
*                                       EX05.CBL
   116     OPEN INPUT ARQALU OUTPUT ARQREP OUTPUT RELAPROV.
   117     PERFORM LEITURA.
   118
   119 LEITURA.
   120     READ ARQALU AT END MOVE "SIM" TO FIM-ARQ.
   121
   122 PRINCIPAL.
   123     PERFORM CALCMEDIA.
   124     PERFORM IMPRESSAO.
   125     PERFORM LEITURA.
   126
   127 CALCMEDIA.
   128     ADD NOTA1-ALU NOTA2-ALU NOTA3-ALU GIVING WSOMA.
   129     DIVIDE WSOMA BY 3 GIVING WMEDIA.
   130
   131 IMPRESSAO.
   132     IF (WMEDIA NOT LESS THAN 7,00) AND
   133        (FALT-ALU LESS THAN 16)
   134         IF CT-LIN GREATER THAN 25
   135             PERFORM CABECALHO
   136         END-IF
   137         PERFORM IMP-DET
   138     ELSE
   139         PERFORM GRAVACAO
   140     END-IF.
   141
   142 CABECALHO.
   143     ADD 1 TO CT-PAG.
   144     MOVE 1 TO CT-LIN.
   145     MOVE CT-PAG TO VAR-PAG.
   146     MOVE SPACES TO REG-ATR.
   147     WRITE REG-ATR AFTER ADVANCING PAGE.
   148     WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   149     WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 2 LINES.
   150     MOVE SPACES TO REG-ATR.
   151     WRITE REG-ATR AFTER ADVANCING 1 LINE.
   152
   153 IMP-DET.
   154     MOVE MAT-P1 TO DET-MATRICULA-P1.
   155     MOVE MAT-P2 TO DET-MATRICULA-P2.
   156     MOVE NOME-ALU TO DET-NOME.
   157     MOVE WMEDIA TO DET-MEDIA.
   158     MOVE FALT-ALU TO DET-FALTAS.
   159     WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   160     ADD 1 TO CT-LIN.
   161     ADD 1 TO CT-ALUNOS-APROVADOS.
   162     ADD WMEDIA TO WSOMA-MEDIAS.
   163
   164 GRAVACAO.
   165     MOVE MATRICULA-ALU TO MATRICULA-REP.
   166     MOVE NOME-ALU TO NOME-REP.
   167     MOVE NOTA1-ALU TO NOTA1-REP.
   168     MOVE NOTA2-ALU TO NOTA2-REP.
   169     MOVE NOTA3-ALU TO NOTA3-REP.
   170     MOVE FALT-ALU TO FALT-REP.
   171     MOVE SEX-ALU TO SEX-REP.
   172     WRITE REG-REP.
   173
* Microsoft COBOL Version 4.5        L2.4 revision 002 16-Oct-23 21:13 Page   4
*                                       EX05.CBL
   174 RODAPE.
   175     DIVIDE WSOMA-MEDIAS BY CT-ALUNOS-APROVADOS
   176         GIVING WMEDIA-TURMA.
   177     MOVE WMEDIA-TURMA TO GER-MEDIA-GERAL.
   178     MOVE CT-ALUNOS-APROVADOS TO TOT-ALUNOS-APROVADOS.
   179     WRITE REG-ATR FROM TOTAL AFTER ADVANCING 4 LINES.
   180     WRITE REG-ATR FROM GERAL AFTER ADVANCING 1 LINES.
   181
   182 TERMINO.
   183     PERFORM RODAPE.
   184     CLOSE ARQALU ARQREP RELAPROV.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1780     Code:         887     Dictionary:        2806
