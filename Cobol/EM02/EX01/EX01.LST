* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Oct-23 19:55 Page   1
*                                       EX01.CBL
* Options: LIST(EX01.LST) ASMLIST(EX01.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX01.
     3 AUTHOR.  LUIZ HENRIQUE DE SANTANA / GABRIEL GOMES DA CRUZ.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 09/10/2023.
     6 DATE-COMPILED. 13-Oct-23 19:55.
     7 SECURITY. APENAS O AUTOR PODE MODIFICAR.
     8*REMARKS.  LER ARQUIVO DE ENTRADA CADSOC1 E SEPARAR OS DADOS DOS
     9*          SOCIOS EM ATRASADOS (RELSOC) E NORMAIS (CADSOC2).
    10
    11 ENVIRONMENT DIVISION.
    12 CONFIGURATION SECTION.
    13     OBJECT-COMPUTER.  IBM-PC.
    14     SOURCE-COMPUTER.  IBM-PC.
    15     SPECIAL-NAMES.    DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19     SELECT CADSOC1 ASSIGN TO DISK ORGANIZATION
    20       IS LINE SEQUENTIAL.
    21     SELECT CADSOC2 ASSIGN TO DISK ORGANIZATION
    22       IS LINE SEQUENTIAL.
    23     SELECT RELSOCIO ASSIGN TO DISK.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27 FD CADSOC1 LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    28     IS "CADSOC1.DAT".
    29
    30     01 REG-SOC1-ENT.
    31       02 COD-PAG1      PIC 9(02).
    32         88 COD-VALIDO VALUE 1 THRU 2.
    33       02 NUM-SOC1      PIC 9(06).
    34       02 NOME-SOC1     PIC X(30).
    35       02 VAL-SOC1      PIC 9(09)V99.
    36
    37 FD CADSOC2 LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    38     IS "CADSOC2.DAT".
    39
    40     01 REG-SOC2-SAI.
    41       02 NUM-SOC2      PIC 9(06).
    42       02 NOME-SOC2     PIC X(30).
    43       02 VAL-SOC2      PIC 9(09)V99.
    44
    45 FD RELSOCIO LABEL RECORD IS OMITTED.
    46     01 REL-SOCIO PIC X(80).
    47
    48 WORKING-STORAGE SECTION.
    49     77 FIM-ARQ PIC X(03) VALUE "NAO".
    50     77 CT-PAG PIC 9(02) VALUE ZEROS.
    51     77 CT-LIN PIC 9(02) VALUE 31.
    52     77 CT-SOC-ATR PIC 9(05) VALUE ZEROES.
    53     77 VAL-SOC-ATR PIC 9(12)V99 VALUE ZEROS.
    54
    55     01 CAB-01.
    56       02 FILLER PIC X(70) VALUE SPACES.
    57       02 FILLER PIC X(05) VALUE "PAG. ".
* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Oct-23 19:55 Page   2
*                                       EX01.CBL
    58       02 VAR-PAG PIC 99.
    59       02 FILLER PIC X(03) VALUE SPACES.
    60
    61     01 CAB-02.
    62       02 FILLER PIC X(27) VALUE SPACES.
    63       02 FILLER PIC X(27) VALUE "RELACAO DE SOCIOS ATRASADOS".
    64       02 FILLER PIC X(26) VALUE SPACES.
    65
    66     01 CAB-03.
    67       02 FILLER PIC X(04) VALUE SPACES.
    68       02 FILLER PIC X(15) VALUE "NUMERO DO SOCIO".
    69       02 FILLER PIC X(13) VALUE SPACES.
    70       02 FILLER PIC X(13) VALUE "NOME DO SOCIO".
    71       02 FILLER PIC X(13) VALUE SPACES.
    72       02 FILLER PIC X(18) VALUE "VALOR DO PAGAMENTO".
    73       02 FILLER PIC X(04) VALUE SPACES.
    74
    75     01 ROD-01.
    76       02 FILLER PIC X(04) VALUE SPACES.
    77       02 FILLER PIC X(27) VALUE "Total de Socios atrasados: ".
    78       02 VAR-SOC-ATR PIC 9(05).
    79       02 FILLER PIC X(44) VALUE SPACES.
    80
    81     01 ROD-02.
    82       02 FILLER PIC X(04) VALUE SPACES.
    83       02 FILLER PIC X(27) VALUE "Valor Total atrasado     : ".
    84       02 VAR-VAL-SOC PIC ZZZ.ZZZ.ZZZ.ZZ9,99.
    85       02 FILLER PIC X(31) VALUE SPACES.
    86
    87     01 DETALHE.
    88       02 FILLER PIC X(08) VALUE SPACES.
    89       02 DET-NUM PIC 999.999.
    90       02 FILLER PIC X(08) VALUE SPACES.
    91       02 DET-NOME PIC X(30).
    92       02 FILLER PIC X(06) VALUE SPACES.
    93       02 DET-VAL PIC ZZZ.ZZZ.ZZ9,99.
    94       02 FILLER PIC X(07) VALUE SPACES.
    95
    96 PROCEDURE DIVISION.
    97 PGM-EX01.
    98     PERFORM INICIO.
    99     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   100     PERFORM TERMINO.
   101     STOP RUN.
   102
   103 INICIO.
   104     OPEN INPUT CADSOC1 OUTPUT CADSOC2 RELSOCIO.
   105     PERFORM LEITURA.
   106
   107 LEITURA.
   108     READ CADSOC1 AT END MOVE "SIM" TO FIM-ARQ.
   109
   110 PRINCIPAL.
   111     PERFORM VALIDACAO.
   112     PERFORM LEITURA.
   113     IF FIM-ARQ EQUAL "SIM"
   114         PERFORM RODAPE-RELSOC.
   115
* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Oct-23 19:55 Page   3
*                                       EX01.CBL
   116 VALIDACAO.
   117     IF COD-VALIDO
   118         IF COD-PAG1 EQUAL 1
   119             PERFORM GRAVA-CADSOC2
   120         ELSE
   121             PERFORM GRAVA-RELSOC.
   122
   123 GRAVA-CADSOC2.
   124     MOVE NUM-SOC1 TO NUM-SOC2.
   125     MOVE NOME-SOC1 TO NOME-SOC2.
   126     MOVE VAL-SOC1 TO VAL-SOC2.
   127     WRITE REG-SOC2-SAI.
   128
   129 GRAVA-RELSOC.
   130     IF CT-LIN GREATER THAN 30
   131         PERFORM CABECALHO-RELSOC.
   132     PERFORM IMP-DET-RELSOC.
   133
   134 CABECALHO-RELSOC.
   135     ADD 1 TO CT-PAG.
   136     MOVE CT-PAG TO VAR-PAG.
   137     MOVE SPACES TO REL-SOCIO.
   138     WRITE REL-SOCIO AFTER ADVANCING PAGE.
   139     WRITE REL-SOCIO FROM CAB-01 AFTER ADVANCING 2 LINE.
   140     WRITE REL-SOCIO FROM CAB-02 AFTER ADVANCING 3 LINES.
   141     WRITE REL-SOCIO FROM CAB-03 AFTER ADVANCING 3 LINES.
   142     MOVE SPACES TO REL-SOCIO.
   143     WRITE REL-SOCIO AFTER ADVANCING 1 LINE.
   144     MOVE 1 TO CT-LIN.
   145
   146 IMP-DET-RELSOC.
   147     MOVE NUM-SOC1 TO DET-NUM.
   148     MOVE NOME-SOC1 TO DET-NOME.
   149     MOVE VAL-SOC1 TO DET-VAL.
   150     WRITE REL-SOCIO FROM DETALHE AFTER ADVANCING 1 LINE.
   151     ADD 1 TO CT-LIN.
   152     ADD 1 TO CT-SOC-ATR.
   153     ADD VAL-SOC1 TO VAL-SOC-ATR.
   154
   155 RODAPE-RELSOC.
   156     MOVE CT-SOC-ATR TO VAR-SOC-ATR.
   157     MOVE VAL-SOC-ATR TO VAR-VAL-SOC.
   158     WRITE REL-SOCIO FROM ROD-01 AFTER ADVANCING 3 LINES.
   159     WRITE REL-SOCIO FROM ROD-02 AFTER ADVANCING 1 LINE.
   160
   161 TERMINO.
   162     CLOSE CADSOC1 CADSOC2 RELSOCIO.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1844     Code:         888     Dictionary:        2365
