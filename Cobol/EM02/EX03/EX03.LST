* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Oct-23 19:53 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX03.
     3 AUTHOR. GABRIEL GOMES DA CRUZ / LUIZ HENRIQUE DE SANTANA.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 11/10/2023.
     6 DATE-COMPILED. 13-Oct-23 19:53.
     7 SECURITY. APENAS O AUTOR PODE MODIFICAR.
     8*REMARKS.  LER OS DADOS DO ARQUIVO DE ENTRADA CADENT E GRAVAR
     9*          NO ARQUIVO DE SAIDA RELSAI OS REGISTROS QUE TIVEREM
    10*          SALARIO MAIORES OU IGUAIS A 5000 E FOREM DO SEXO
    11*          FEMININO.
    12
    13 ENVIRONMENT DIVISION.
    14 CONFIGURATION SECTION.
    15     SOURCE-COMPUTER. IBM-PC.
    16     OBJECT-COMPUTER. IBM-PC.
    17     SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    18
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21     SELECT CADENT ASSIGN TO DISK ORGANIZATION IS
    22         LINE SEQUENTIAL.
    23     SELECT RELSAI ASSIGN TO DISK.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27 FD CADENT LABEL RECORD ARE STANDARD VALUE OF FILE-ID IS
    28     "CADENT.DAT".
    29
    30     01 REG-ENT.
    31       02 COD-ENT      PIC 9(07).
    32       02 NOME-ENT     PIC X(30).
    33       02 SAL-ENT      PIC 9(5)V99.
    34       02 SEX0-ENT     PIC X(01).
    35
    36 FD RELSAI LABEL RECORD IS OMITTED.
    37     01 REL-SAI PIC X(80).
    38
    39 WORKING-STORAGE SECTION.
    40     77 FIM-ARQ PIC X(03) VALUE "NAO".
    41     77 CT-LIN PIC 9(02) VALUE 21.
    42     77 CT-PAG PIC 9(03) VALUE ZEROS.
    43     77 CT-CLIE PIC 9(02) VALUE ZEROS.
    44     77 WSAL-CLIE PIC 9(09)V99 VALUE ZEROS.
    45
    46     01 CAB-01.
    47       02 FILLER PIC X(70) VALUE SPACES.
    48       02 FILLER PIC X(05) VALUE "Pag. ".
    49       02 CAB-PAG PIC 9(03).
    50       02 FILLER PIC X(02) VALUE SPACES.
    51
    52     01 CAB-02.
    53       02 FILLER PIC X(21) VALUE SPACES.
    54       02 FILLER PIC X(38) VALUE
    55         "LISTAGEM DOS CLIENTES DO SEXO FEMININO".
    56       02 FILLER PIC X(21) VALUE SPACES.
    57
* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Oct-23 19:53 Page   2
*                                       EX03.CBL
    58     01 CAB-03.
    59       02 FILLER PIC X(23) VALUE SPACES.
    60       02 FILLER PIC X(34) VALUE
    61         "COM SALARIOS SUPERIORES A 5.000,00".
    62       02 FILLER PIC X(23) VALUE SPACES.
    63
    64     01 CAB-04.
    65       02 FILLER PIC X(08) VALUE SPACES.
    66       02 FILLER PIC X(06) VALUE "CODIGO".
    67       02 FILLER PIC X(24) VALUE SPACES.
    68       02 FILLER PIC X(04) VALUE "NOME".
    69       02 FILLER PIC X(24) VALUE SPACES.
    70       02 FILLER PIC X(07) VALUE "SALARIO".
    71       02 FILLER PIC X(08) VALUE SPACES.
    72
    73     01 ROD-01.
    74       02 FILLER PIC X(05) VALUE SPACES.
    75       02 FILLER PIC X(29) VALUE
    76         "Total de Clientes impressos: ".
    77       02 ROD-TOT-CLIE PIC ZZ.999.
    78       02 FILLER PIC X(41) VALUE SPACES.
    79
    80     01 ROD-02.
    81       02 FILLER PIC X(05) VALUE SPACES.
    82       02 FILLER PIC X(18) VALUE "Total de Salario: ".
    83       02 ROD-TOT-SAL PIC ZZZ.ZZZ.ZZ9,99.
    84       02 FILLER PIC X(48).
    85
    86     01 DETALHE.
    87       02 FILLER PIC X(08) VALUE SPACES.
    88       02 DET-COD PIC X(07).
    89       02 FILLER PIC X(09) VALUE SPACES.
    90       02 DET-NOME PIC X(30).
    91       02 FILLER PIC X(10) VALUE SPACES.
    92       02 DET-SAL PIC ZZ.999,99.
    93       02 FILLER PIC X(07) VALUE SPACES.
    94
    95 PROCEDURE DIVISION.
    96 PGM-EX02.
    97     PERFORM INICIO.
    98     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    99     PERFORM TERMINO.
   100     STOP RUN.
   101
   102 INICIO.
   103     OPEN INPUT CADENT OUTPUT RELSAI.
   104     PERFORM LEITURA.
   105
   106 LEITURA.
   107     READ CADENT AT END MOVE "SIM" TO FIM-ARQ.
   108
   109 PRINCIPAL.
   110     PERFORM VALIDACAO.
   111     PERFORM LEITURA.
   112     IF FIM-ARQ EQUAL "SIM"
   113         PERFORM RODAPE.
   114
   115 VALIDACAO.
* Microsoft COBOL Version 4.5        L2.4 revision 002 13-Oct-23 19:53 Page   3
*                                       EX03.CBL
   116     IF SAL-ENT NOT LESS THAN 5000,00 AND
   117       (SEX0-ENT EQUAL "F" OR "f")
   118         PERFORM IMPRESSAO.
   119
   120 IMPRESSAO.
   121     IF CT-LIN GREATER THAN 20
   122         PERFORM CABECALHO.
   123     PERFORM IMPRIME-DET.
   124
   125 CABECALHO.
   126     MOVE 1 TO CT-LIN.
   127     ADD 1 TO CT-PAG.
   128     MOVE CT-PAG TO CAB-PAG.
   129     MOVE SPACES TO REL-SAI.
   130     WRITE REL-SAI FROM CAB-01 AFTER ADVANCING 1 LINE.
   131     WRITE REL-SAI FROM CAB-02 AFTER ADVANCING 1 LINE.
   132     WRITE REL-SAI FROM CAB-03 AFTER ADVANCING 1 LINE.
   133     WRITE REL-SAI FROM CAB-04 AFTER ADVANCING 3 LINES.
   134     MOVE SPACES TO REL-SAI.
   135     WRITE REL-SAI AFTER ADVANCING 1 LINE.
   136
   137 RODAPE.
   138     MOVE CT-CLIE TO ROD-TOT-CLIE.
   139     MOVE WSAL-CLIE TO ROD-TOT-SAL.
   140     WRITE REL-SAI FROM ROD-01 AFTER ADVANCING 3 LINES.
   141     WRITE REL-SAI FROM ROD-02 AFTER ADVANCING 1 LINE.
   142
   143 IMPRIME-DET.
   144     MOVE COD-ENT TO DET-COD.
   145     MOVE NOME-ENT TO DET-NOME.
   146     MOVE SAL-ENT TO DET-SAL.
   147     WRITE REL-SAI FROM DETALHE AFTER ADVANCING 1 LINE.
   148     ADD 1 TO CT-LIN.
   149     ADD 1 TO CT-CLIE.
   150     ADD SAL-ENT TO WSAL-CLIE.
   151
   152 TERMINO.
   153     CLOSE CADENT RELSAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1724     Code:         760     Dictionary:        1956
