* Microsoft COBOL Version 4.5        L2.4 revision 002 14-Oct-23 21:25 Page   1
*                                       EX04.CBL
* Options: LIST(EX04.LST) ASMLIST(EX04.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EX04.
     3 AUTHOR. GABRIEL GOMES DA CRUZ / LUIZ HENRIQUE DE SANTANA.
     4 INSTALLATION. FATEC-SP.
     5 DATE-WRITTEN. 12/10/2023.
     6 DATE-COMPILED. 14-Oct-23 21:25.
     7 SECURITY. APENAS O AUTOR PODE MODIFICAR.
     8
     9 ENVIRONMENT DIVISION.
    10 CONFIGURATION SECTION.
    11     OBJECT-COMPUTER. IBM-PC.
    12     SOURCE-COMPUTER. IBM-PC.
    13     SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    14
    15 INPUT-OUTPUT SECTION.
    16 FILE-CONTROL.
    17     SELECT CADESTOQ ASSIGN TO DISK ORGANIZATION is
    18         LINE SEQUENTIAL.
    19     SELECT RELESTOQ ASSIGN TO DISK.
    20
    21 DATA DIVISION.
    22 FILE SECTION.
    23
    24 FD CADESTOQ LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    25   IS "CADESTOQ.DAT".
    26     01 REG-ENT.
    27       02 COD-ENT        PIC 9(05).
    28       02 NOME-ENT       PIC X(15).
    29       02 QNTD-ENT       PIC 9(05).
    30       02 PRECO-UNI-ENT  PIC 9(06)V99.
    31
    32 FD RELESTOQ LABEL RECORD IS OMITTED.
    33     01 REL-ESTOQ PIC X(80).
    34
    35 WORKING-STORAGE SECTION.
    36     77 FIM-ARQ PIC X(03) VALUE "NAO".
    37     77 CT-LIN  PIC 9(02) VALUE 27.
    38     77 CT-PAG  PIC 9(03) VALUE ZEROS.
    39     77 WCUSTO-TOT PIC 9(07)V99.
    40
    41     77 WPRECO-TOT   PIC 9(08)V99 VALUE ZEROS.
    42     77 WPRECO-MEDIO PIC 9(06)V99 VALUE ZEROS.
    43     77 WQTND-TOT    PIC 9(07) VALUE ZEROS.
    44
    45     01 CAB-01.
    46       02 FILLER PIC X(02) VALUE SPACES.
    47       02 FILLER PIC X(06) VALUE "DATA: ".
    48       02 DIA PIC 99 VALUE 12.
    49       02 FILLER PIC X(01) VALUE "/".
    50       02 MES PIC 99 VALUE 10.
    51       02 FILLER PIC X(01) VALUE "/".
    52       02 ANO PIC 9999 VALUE 2023.
    53
    54       02 FILLER PIC X(10) VALUE SPACES.
    55       02 FILLER PIC X(33) VALUE
    56        "RELATÓRIO DE MATERIAL EM ESTOQUE".
    57
* Microsoft COBOL Version 4.5        L2.4 revision 002 14-Oct-23 21:25 Page   2
*                                       EX04.CBL
    58       02 FILLER PIC X(09) VALUE SPACES.
    59       02 FILLER PIC X(05) VALUE "PAG. ".
    60       02 VAR-PAG PIC 9(03).
    61       02 FILLER PIC X(02) VALUE SPACES.
    62
    63     01 CAB-02.
    64       02 FILLER PIC X(05) VALUE SPACES.
    65       02 FILLER PIC X(06) VALUE "CODIGO".
    66       02 FILLER PIC X(09) VALUE SPACES.
    67       02 FILLER PIC X(04) VALUE "NOME".
    68       02 FILLER PIC X(10) VALUE SPACES.
    69       02 FILLER PIC X(07) VALUE "QTDE DO".
    70       02 FILLER PIC X(04) VALUE SPACES.
    71       02 FILLER PIC X(14) VALUE "CUSTO UNITARIO".
    72       02 FILLER PIC X(04) VALUE SPACES.
    73       02 FILLER PIC X(11) VALUE "CUSTO TOTAL".
    74       02 FILLER PIC X(06) VALUE SPACES.
    75
    76     01 CAB-03.
    77       02 FILLER PIC X(34) VALUE SPACES.
    78       02 FILLER PIC X(07) VALUE "ESTOQUE".
    79       02 FILLER PIC X(39) VALUE SPACES.
    80
    81     01 DETALHE.
    82       02 FILLER PIC X(05) VALUE SPACES.
    83       02 DET-COD PIC 99999.
    84       02 FILLER PIC X(04) VALUE SPACES.
    85       02 DET-NOME PIC X(15).
    86       02 FILLER PIC X(05) VALUE SPACES.
    87       02 DET-QNTD PIC ZZ.ZZ9.
    88       02 FILLER PIC X(06) VALUE SPACES.
    89       02 DET-CUSTO-UNI PIC ZZZ.ZZ9,99.
    90       02 FILLER PIC X(05) VALUE SPACES.
    91       02 DET-CUSTO-TOT PIC Z.ZZZ.ZZ9,99.
    92       02 FILLER PIC X(06) VALUE SPACES.
    93
    94     01 CAB-04.
    95       02 FILLER PIC X(08) VALUE SPACES.
    96       02 FILLER PIC X(16) VALUE "QUANTIDADE TOTAL".
    97       02 FILLER PIC X(11) VALUE SPACES.
    98       02 FILLER PIC X(13) VALUE "PREÇO MÉDIO".
    99       02 FILLER PIC X(12) VALUE SPACES.
   100       02 FILLER PIC X(12) VALUE "PREÇO TOTAL".
   101       02 FILLER PIC X(08) VALUE SPACES.
   102
   103     01 DETALHE2.
   104       02 FILLER PIC X(12) VALUE SPACES.
   105       02 DET-QUTD-TOTAL-REL PIC Z.ZZZ.ZZ9 VALUE ZEROS.
   106       02 FILLER PIC X(15) VALUE SPACES.
   107       02 DET-PRECO-MEDIO-REL PIC ZZZ.ZZ9,99.
   108       02 FILLER PIC X(14) VALUE SPACES.
   109       02 DET-PRECO-TOTAL-REL PIC ZZ.ZZZ.ZZ9,99.
   110       02 FILLER PIC X(07) VALUE SPACES.
   111
   112 PROCEDURE DIVISION.
   113 PGM-EX04.
   114     PERFORM INICIO.
   115     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
* Microsoft COBOL Version 4.5        L2.4 revision 002 14-Oct-23 21:25 Page   3
*                                       EX04.CBL
   116     PERFORM TERMINO.
   117     STOP RUN.
   118
   119 INICIO.
   120     OPEN INPUT CADESTOQ OUTPUT RELESTOQ.
   121     PERFORM LEITURA.
   122
   123 LEITURA.
   124     READ CADESTOQ AT END MOVE "SIM" TO FIM-ARQ.
   125
   126 PRINCIPAL.
   127     PERFORM IMPRESSAO.
   128     PERFORM LEITURA.
   129
   130 IMPRESSAO.
   131     IF CT-LIN GREATER THAN 25
   132         PERFORM CABECALHO.
   133     PERFORM IMPRIME-DET.
   134
   135 CABECALHO.
   136     MOVE 1 TO CT-LIN.
   137     ADD 1 TO CT-PAG.
   138     MOVE CT-PAG TO VAR-PAG.
   139     MOVE SPACES TO REL-ESTOQ.
   140     WRITE REL-ESTOQ AFTER ADVANCING PAGE.
   141     WRITE REL-ESTOQ FROM CAB-01 AFTER ADVANCING 1 LINE.
   142     WRITE REL-ESTOQ FROM CAB-02 AFTER ADVANCING 3 LINES.
   143     WRITE REL-ESTOQ FROM CAB-03 AFTER ADVANCING 1 LINE.
   144     MOVE SPACES TO REL-ESTOQ.
   145     WRITE REL-ESTOQ AFTER ADVANCING 1 LINE.
   146
   147 IMPRIME-DET.
   148     ADD 1 TO CT-LIN.
   149     MULTIPLY PRECO-UNI-ENT BY QNTD-ENT GIVING WCUSTO-TOT.
   150     MOVE COD-ENT TO DET-COD.
   151     MOVE NOME-ENT TO DET-NOME.
   152     MOVE QNTD-ENT TO DET-QNTD.
   153     MOVE PRECO-UNI-ENT TO DET-CUSTO-UNI.
   154     MOVE WCUSTO-TOT TO DET-CUSTO-TOT.
   155     WRITE REL-ESTOQ FROM DETALHE AFTER ADVANCING 1 LINE.
   156
   157     ADD QNTD-ENT TO WQTND-TOT.
   158     ADD WCUSTO-TOT TO WPRECO-TOT.
   159
   160 IMPRIME-TOT.
   161     ADD 1 TO CT-PAG.
   162     MOVE CT-PAG TO VAR-PAG.
   163     MOVE SPACES TO REL-ESTOQ.
   164     WRITE REL-ESTOQ AFTER ADVANCING PAGE.
   165     WRITE REL-ESTOQ FROM CAB-01 AFTER ADVANCING 1 LINE.
   166     WRITE REL-ESTOQ FROM CAB-04 AFTER ADVANCING 3 LINES.
   167     MOVE SPACES TO REL-ESTOQ.
   168     WRITE REL-ESTOQ AFTER ADVANCING 1 LINE.
   169
   170     DIVIDE WPRECO-TOT BY WQTND-TOT GIVING WPRECO-MEDIO.
   171     MOVE WQTND-TOT TO DET-QUTD-TOTAL-REL.
   172     MOVE WPRECO-MEDIO TO DET-PRECO-MEDIO-REL.
   173     MOVE WPRECO-TOT TO DET-PRECO-TOTAL-REL.
* Microsoft COBOL Version 4.5        L2.4 revision 002 14-Oct-23 21:25 Page   4
*                                       EX04.CBL
   174     WRITE REL-ESTOQ FROM DETALHE2 AFTER ADVANCING 1 LINE.
   175
   176 TERMINO.
   177     PERFORM IMPRIME-TOT.
   178     CLOSE CADESTOQ RELESTOQ.
   179
   180
   181
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1628     Code:         886     Dictionary:        2254
