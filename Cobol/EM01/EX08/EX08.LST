* Microsoft COBOL Version 4.5        L2.4 revision 002 10-Sep-23 15:24 Page   1
*                                       EX08.CBL
* Options: LIST(EX08.LST) ASMLIST(EX08.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX08.
     3 AUTHOR.        GABRIEL GOMES DA CRUZ.
     4 INSTALLATION.  FATEC-SP.
     5 DATE-WRITTEN.  10/09/2023.
     6 DATE-COMPILED. 10-Sep-23 15:24.
     7 SECURITY. APENAS O AUTOR MODIFICAR.
     8*REMARKS.  LER O ARQUIVO DE ENTRADA CADFUN (CODIGO, NOME E
     9*          SALARIO BRUTO), CALCULAR O REAJUSTE DO SALARIO E
    10*          GRAVAR NO ARQUIVO DE SAIDA CADSAI (CODIGO, NOME E
    11*          SALARIO REAJUSTADO).
    12
    13 ENVIRONMENT DIVISION.
    14 CONFIGURATION SECTION.
    15 SOURCE-COMPUTER.  ACER-PC.
    16 OBJECT-COMPUTER.  IBM-PC.
    17 SPECIAL-NAMES.    DECIMAL-POINT IS COMMA.
    18
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21     SELECT CADFUN ASSIGN TO DISK ORGANIZATION
    22         IS LINE SEQUENTIAL.
    23
    24     SELECT CADSAI ASSIGN TO DISK ORGANIZATION
    25         IS LINE SEQUENTIAL.
    26
    27 DATA DIVISION.
    28 FILE SECTION.
    29     FD CADFUN LABEL RECORD ARE STANDARD VALUE OF
    30         FILE-ID IS "CADFUN.DAT".
    31
    32     01 REG-ENT.
    33     02 COD-ENT        PIC 9(05).
    34     02 NOME-ENT       PIC X(20).
    35     02 SAL-BRUTO-ENT  PIC 9(05)V99.
    36
    37     FD CADSAI LABEL RECORD ARE STANDARD VALUE OF
    38         FILE-ID IS "CADSAI.DAT".
    39
    40     01 REG-SAI.
    41     02 COD-SAI       PIC 9(05).
    42     02 NOME-SAI      PIC X(20).
    43     02 SAL-REAJ-SAI  PIC 9(05)V99.
    44
    45 WORKING-STORAGE SECTION.
    46     77 FIM-ARQ PIC X(3) VALUE "NAO".
    47     77 SAL-REAJUSTADO PIC 9(05)V99 VALUE ZEROS.
    48
    49 PROCEDURE DIVISION.
    50 PGM-EX08.
    51     PERFORM INICIO.
    52     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    53     PERFORM TERMINO.
    54     STOP RUN.
    55
    56 INICIO.
    57     OPEN INPUT CADFUN OUTPUT CADSAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002 10-Sep-23 15:24 Page   2
*                                       EX08.CBL
    58     PERFORM LEITURA.
    59
    60 LEITURA.
    61     READ CADFUN AT END MOVE "SIM" TO FIM-ARQ.
    62
    63 PRINCIPAL.
    64     PERFORM REAJUSTE.
    65     PERFORM GRAVACAO.
    66     PERFORM LEITURA.
    67
    68 REAJUSTE.
    69     IF SAL-BRUTO-ENT NOT GREATER THAN 1000,00
    70         MULTIPLY SAL-BRUTO-ENT BY 0,88
    71             GIVING SAL-REAJUSTADO
    72     ELSE
    73         IF SAL-BRUTO-ENT NOT GREATER THAN 2000,00
    74             MULTIPLY SAL-BRUTO-ENT BY 0,89
    75                 GIVING SAL-REAJUSTADO
    76         ELSE
    77             MULTIPLY SAL-BRUTO-ENT BY 0,90
    78                 GIVING SAL-REAJUSTADO.
    79
    80 GRAVACAO.
    81     MOVE COD-ENT TO COD-SAI.
    82     MOVE NOME-ENT TO NOME-SAI.
    83     MOVE SAL-REAJUSTADO TO SAL-REAJ-SAI.
    84     WRITE REG-SAI.
    85
    86 TERMINO.
    87     CLOSE CADFUN CADSAI.
    88
    89
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1044     Code:         405     Dictionary:        1172
