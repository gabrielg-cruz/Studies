* Microsoft COBOL Version 4.5        L2.4 revision 002 05-Sep-23 19:44 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX03.
     3 AUTHOR.        GABRIEL GOMES DA CRUZ.
     4 INSTALLATION.  FATEC-SP.
     5 DATE-WRITTEN.  05/09/2023.
     6 DATE-COMPILED. 05-Sep-23 19:44.
     7 SECURITY. APENAS O AUTOR PODE MODIFICAR.
     8*REMARKS. LE OS REGISTROS DE ENTRADA CADALU (NUMERO, NOME,
     9*         NOTA1, NOTA2, NOTA3) E GRAVA NO MARQUIVO DE SAIDA
    10*         CADATU (NUMERO, MEDIA).
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
    14     SOURCE-COMPUTER. ACER-PC.
    15     OBJECT-COMPUTER. HP-PC.
    16     SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19     SELECT CADALU ASSIGN TO DISK ORGANIZATION
    20         IS LINE SEQUENTIAL.
    21     SELECT CADATU ASSIGN TO DISK ORGANIZATION
    22         IS LINE SEQUENTIAL.
    23
    24 DATA DIVISION.
    25 FILE SECTION.
    26     FD CADALU LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    27         IS "CADALU.DAT".
    28     01 REG-ENT.
    29     02 NUM-ENT       PIC 9(05).
    30     02 NOME-ENT      PIC X(20).
    31     02 NOTA1-ENT     PIC 9(02)V99.
    32     02 NOTA2-ENT     PIC 9(02)V99.
    33     02 NOTA3-ENT     PIC 9(02)V99.
    34
    35     FD CADATU LABEL RECORD ARE STANDARD VALUE OF FILE-ID
    36         IS "CADATU.DAT".
    37     01 REG-SAI.
    38     02 NUM-SAI      PIC 9(05).
    39     02 MEDIA-SAI     PIC 9(02)V99.
    40
    41 WORKING-STORAGE SECTION.
    42     77 FIM-ARQ    PIC X(03) VALUE "NAO".
    43     77 WMEDIA     PIC 9(02)V99 VALUE ZEROS.
    44     77 SOMA-NOTA  PIC 9(02)V99.
    45
    46 PROCEDURE DIVISION.
    47 PGM-EX03.
    48     PERFORM INICIO.
    49     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
    50     PERFORM TERMINO.
    51     STOP RUN.
    52
    53 INICIO.
    54     OPEN INPUT CADALU OUTPUT CADATU.
    55     PERFORM LEITURA.
    56
    57 LEITURA.
* Microsoft COBOL Version 4.5        L2.4 revision 002 05-Sep-23 19:44 Page   2
*                                       EX03.CBL
    58     READ CADALU AT END MOVE "SIM" TO FIM-ARQ.
    59
    60 PRINCIPAL.
    61     PERFORM CALCMEDIA.
    62     PERFORM GRAVACAO.
    63     PERFORM LEITURA.
    64
    65 CALCMEDIA.
    66     ADD NOTA1-ENT, NOTA2-ENT, NOTA3-ENT
    67         GIVING SOMA-NOTA.
    68     DIVIDE SOMA-NOTA BY 3 GIVING WMEDIA.
    69
    70 GRAVACAO.
    71     MOVE NUM-ENT TO NUM-SAI.
    72     MOVE WMEDIA TO MEDIA-SAI.
    73     WRITE REG-SAI.
    74
    75 TERMINO.
    76     CLOSE CADALU CADATU.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1032     Code:         352     Dictionary:        1252
